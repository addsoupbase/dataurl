<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta property="og:title" content="Convert file to DataURL">
    <meta name="viewport" content="width=device-width, height=device-height, initial-scale=0.9">
    <title>File to DataURL</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="stylesheet" href="https://addsoupbase.github.io/favourites/main.css">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Pacifico&display=swap" rel="stylesheet">
    <style>
        /* HTML: <div class="loader"></div> */
        .pulsate-bck {
            -webkit-animation: pulsate-bck .5s ease-in-out both;
            animation: pulsate-bck .5s ease-in-out both
        }

        .shake {
            animation: myAnim 0.5s ease 0s 1 normal forwards;
        }

        @keyframes myAnim {

            0%,
            100% {
                transform: translateX(0);
            }

            10%,
            30%,
            50%,
            70% {
                transform: translateX(-10px);
            }

            20%,
            40%,
            60% {
                transform: translateX(10px);
            }

            80% {
                transform: translateX(8px);
            }

            90% {
                transform: translateX(-8px);
            }
        }

        /* ----------------------------------------------
 * Generated by Animista on 2024-9-29 14:53:8
 * Licensed under FreeBSD License.
 * See http://animista.net/license for more info. 
 * w: http://animista.net, t: @cssanimista
 * ---------------------------------------------- */
        #hint {
            position: fixed;
            max-width: 400px;
            top: 25%;
            height: 250px;
            padding: 20px;
            background-color: pink;
            border-radius: 2%;
        }

        .huh {
            position: fixed;
            width: 30px;
            display: inline;
            height: 30px;
            bottom: 10px;
            right: 10px;
            cursor: help;
            border-radius: 100%;
            border-color: rgb(212, 0, 255);
            border-width: 0px;
            z-index: 2;
            color: magenta;
            background-color: rgb(255, 255, 255);
        }

        .huh:hover {
            background-color: rgb(203, 203, 203);
        }

        @-webkit-keyframes pulsate-bck {
            0% {
                -webkit-transform: scale(1);
                transform: scale(1)
            }

            50% {
                -webkit-transform: scale(.9);
                transform: scale(.9)
            }

            100% {
                -webkit-transform: scale(1);
                transform: scale(1)
            }
        }

        video {
            max-width: 250px;
            border-radius: 5%;
            max-height: 250px
        }

        @keyframes pulsate-bck {
            0% {
                -webkit-transform: scale(1);
                transform: scale(1)
            }

            50% {
                -webkit-transform: scale(.9);
                transform: scale(.9)
            }

            100% {
                -webkit-transform: scale(1);
                transform: scale(1)
            }
        }

        .pacifico-regular {
            font-family: "Pacifico", cursive;
            font-weight: 400;
            font-style: normal;
        }

        #main {
            max-height: 40%;
        }

        .loader {
            width: 30px;
            aspect-ratio: 1;
            display: grid;
            margin: 10px;
            /* -webkit-mask: conic-gradient(from 15deg, #0000, #000);*/
            animation: l26 1s infinite steps(12);
        }

        .loader,
        .loader:before,
        .loader:after {
            background:
                radial-gradient(closest-side at 50% 12.5%, #dc9e9e 96%, #0000) 50% 0 / 20% 80% repeat-y, radial-gradient(closest-side at 12.5% 50%, #ffffff 96%, #0000) 0 50% / 80% 20% repeat-x
        }

        .loader:before,
        .loader:after {
            content: "";
            grid-area: 1/1;
            transform: rotate(30deg);
        }

        .loader:after {
            transform: rotate(60deg);
        }

        @keyframes l26 {
            100% {
                transform: rotate(1turn)
            }
        }

        .cute-button {
            padding: 15px 25px;
            font-size: 16px;
            color: white;
            background-color: #ff6b81;
            /* Soft pink color */
            border: none;
            margin: 10px;
            border-radius: 5px;
            /* Rounded corners */
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
            cursor: pointer;
            transition: background-color 0.3s, transform 0.2s;
        }

        .cute-button2 {
            padding: 10px 20px;
            font-size: 16px;
            color: white;
            background-color: #ff6b81;
            /* Soft pink color */
            border: none;
            margin: 1px;
            border-radius: 5px;
            /* Rounded corners */
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
            cursor: pointer;
            transition: background-color 0.3s, transform 0.2s;
        }

        .cute-button:hover {
            background-color: #ff4d69;
            /* Darker pink on hover */
            transform: scale(1.05);
            /* Slightly larger on hover */
        }

        .cute-button:active {
            transform: scale(0.95);
            /* Smaller when clicked */
        }

        .cute-input {
            padding: 15px;
            caret-color: red;
            caret-shape: block;
            font-size: 16px;
            color: #333;
            border: 2px solid #ff6b81;
            /* Soft pink border */
            border-radius: 5px;
            /* Rounded corners */
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
            outline: none;
            /* Remove default outline */
            filter: drop-shadow(0 0mm 0mm rgb(160, 0, 210));
            transition: border-color 0.3s, box-shadow 0.3s, filter 0.3s;
            margin-left: auto;
            margin-right: auto;
        }

        kbd {
            margin: 30px;
            text-align: center;
            font-size: 30px
        }

        .heart {
            width: 50px;
            height: 50px;
            background-image: url('heart.svg');
            background-size: contain;
            background-repeat: no-repeat;
            color:pink;   
            position: absolute;
            z-index: -1;
            opacity: 0.5;
            filter: invert(83%) sepia(37%) saturate(1309%) hue-rotate(301deg) brightness(97%) contrast(103%);
        }
    </style>
</head>

<body>
    <script src="https://addsoupbase.github.io/favourites/utils.js">
    </script>
    <script>
'use strict';
for (let i = 10; --i;) {
    new Elem({tag:'div',class:['heart'],parent:body,styles: {
    transform: `rotate(${ran.range(0,360)}deg)`,
    top: `${ran.range(0,100)}%`,
    left: `${ran.range(0,100)}%`,

}});
}

function separate(txt) {
            return txt.split('\n').filter(line => line.trim() !== '')
        }
        let mai = new Elem({
            class: ['pacifico-regular'],
            tag: 'div', parent: body, styles: {
                'overflow-y': 'scroll',
                'height': '95vh',
                'scrollbar-color': '#ff6b81 #FFF',
                width: '100%',
                'justify-items': 'center',
                'text-align': 'center',

            }
        })
        body.styleMe({
            'justify-content': 'center',
            display: 'flex',
            overflow: 'hidden',
            'background-color': color.dhk('#ff6b81', 10)
        })
        let asinds = new Elem({
            tag: 'div', parent: mai, id: 'main', styles: {
                'text-align': 'center',
                display: 'inline-grid',
                'margin-left': '30px',
                'margin-right': '30px',

            }
        })
        let desc = new Elem({ tag: 'h1', parent: asinds, text: 'File â†’ DATAurl' })
        new Elem({
            tag: 'button', class: ['huh'], parent: body,
            title: 'Help',
            alt: 'Help',
            text: '?', events: {
                click() {
                    hint.show()
                    hint.fadeIn()
                    this.content.fadeOut(this.content.kill)
                }
            }
        })
        let input = new Elem({
            class: ['cute-input'],
            tag: 'textarea', styles: {
                width: '300px',
                height: '100px',
            }, parent: 'main', placeholder: 'urls go here, separated by new line (enter key)'
        })
        let inputButton = new Elem({
            class: ['cute-button'], tag: 'button', text: 'Get from urls (might not work)', parent: 'main', events: {
                click() {

                    let text = input.value
                    if (!text) return input.anim({ class: 'shake' });
                    loadUrls(separate(text))
                }
            }
        })

        new Elem({ tag: 'p', parent: 'main', text: 'OR' })
        let upload = new Elem({
            events: {
                change(e) {

                    loadFiles(e.target.files)
                }
            },
            multiple: 'true', tag: 'input', type: 'file',
        })
        let fileButton = new Elem({
            class: ['cute-button'], tag: 'button', text: 'Files Upload', parent: 'main', events: {
                click() {
                    upload.content.click()
                }
            }
        })
        let r = new Elem({
            tag: 'div', parent: 'main', id: 'urlresults', styles: {
                'text-align': 'center',
                'height': '400px',
                'margin-bottom': '100px',
                'overflow-y': 'scroll',
                'border-color': '#f99aaa',
                'border-width': '2px',
                'padding': '10px',
                'border-style': 'solid',
                'background-color': `rgb(230, 96, 116)`,
                'scrollbar-color': '#FFFFFF #ff6b81',
                'max-height': '400px'

            }
        })
        async function loadUrls(urls) {
            for (let o of urls) {
                let data;
                let a = ran.gen(), a2 = ran.gen(), a3 = ran.gen(), a4 = ran.gen(), a5 = ran.gen(), a6 = ran.gen()
                let outer = new Elem({
                    tag: 'div',
                    parent: r,
                    start() {
                        this.fadeIn()
                    },
                    styles: {
                        'display': 'flex',
                        'align-items': 'center',
                        'justify-content': 'center',
                        'max-width': '300px',

                    },
                    children: [
                        new Elem({ tag: 'div', class: ['loader'], id: a2 }),
                        new Elem({
                            tag: 'div', id: a6, styles: { display: 'grid' }, children: [
                                new Elem({ tag: 'button', class: ['cute-button2', 'cute-button'], text: 'Download', id: a3 }),
                                new Elem({ tag: 'button', class: ['cute-button2', 'cute-button'], text: 'Copy', id: a4 }),
                                new Elem({ tag: 'button', class: ['cute-button2', 'cute-button'], text: 'View', id: a5 }),

                            ]
                        })

                    ], id: a
                })
                let result = new Elem({ tag: 'p', styles: { 'font-size': '20px' }, text: ``, parent: a })
                try { data = await getDataUrl(o) }
                catch (e) {
                    result.styleMe({ color: 'darkred' })
                    result.innerHTML = '(failed)'
                    _('#' + a2).kill()
                    _('#' + a6).kill()

                    continue
                }
                let image = _('#' + a2)

                let download = _('#' + a3)
                download.addevent({
                    click() {
                        let _blob = new Blob([data], { type: 'text/plain' })
                        let link = URL.createObjectURL(_blob)
                        let anchor = document.createElement('a')
                        anchor.setAttribute('download', 'data.txt')
                        anchor.href = link
                        document.body.appendChild(anchor)
                        anchor.click()
                    }
                })
                result.kill()

                image.removeClass('loader')
                finish({
                    data,
                    viewButton: _('#' + a5),
                    mainContent: image,
                    fileName: o

                })
            }

        }
        async function loadFiles(files) {
            let urls = []
            for (let file of files) {
                let a2 = ran.gen(), a = ran.gen(), a3 = ran.gen(), a4 = ran.gen(), a5 = ran.gen();
                let outer = new Elem({
                    tag: 'div',
                    parent: r,
                    alt: file.name,
                    title: file.name,
                    start() {
                        this.fadeIn()
                    },
                    styles: {
                        'display': 'flex',
                        'align-items': 'center',
                        'justify-content': 'center',
                        'max-width': '300px',

                    },
                    children: [
                        new Elem({ tag: 'div', class: ['loader'], id: a2 }),
                        new Elem({
                            tag: 'div', styles: { display: 'grid' }, children: [
                                new Elem({ tag: 'button', class: ['cute-button2', 'cute-button'], text: 'Download', id: a3 }),
                                new Elem({ tag: 'button', class: ['cute-button2', 'cute-button'], text: 'Copy', id: a4 }),
                                new Elem({ tag: 'button', class: ['cute-button2', 'cute-button'], text: 'View', id: a5 }),

                            ]
                        }),


                    ], id: a
                })
                let reader = new FileReader
                reader.onload = e => {
                    let dataUrl = e.target.result
                    let out = _(a2)
                    out.removeClass('loader')
                    let download = _(a3)
                    download.addevent({
                        click() {
                            let _blob = new Blob([dataUrl], { type: 'text/plain' })
                            let link = URL.createObjectURL(_blob)
                            let anchor = document.createElement('a')
                            anchor.setAttribute('download', 'data.txt')
                            anchor.href = link
                            document.body.appendChild(anchor)
                            anchor.click()
                            this.content.anim({ class: ['pulsate-bck'] })

                        }
                    })

                    let view = _(a5),
                        copy = _(a4)
                    copy.addevent({
                        click: async function () {
                            await navigator.clipboard.writeText(dataUrl)
                            this.content.anim({ class: ['pulsate-bck'] })
                        }
                    })
                    finish({
                        data: dataUrl,
                        viewButton: view,
                        mainContent: out,
                        fileName: file.name

                    })
                }
                reader.readAsDataURL(file)
            }

        }
        let hint = new Elem({ tag: 'div', id: 'hint', parent: body })
        new Elem({ tag: 'p', parent: hint, text: 'DataURLs can be used to save images and other files as plain text and use them directly in HTML and CSS. This tool makes it quick and easy to convert them to DataURLs' })
        new Elem({
            tag: 'button', class: ['cute-button'], text: 'OK', parent: hint, events: {
                click() {
                    hint.fadeOut(hint.hide)
                }
            }
        })
        hint.hide()
        function finish({ data, viewButton, mainContent, fileName }) {
            if (data.match(/image\/(webp|jpg|jpeg|png|svg|gif|apng|avif|bmp|ico|tiff)/)) {
                viewButton.addevent({
                    click() {
                        let w = open()
                        let f = w.document.createElement('img')
                        f.src = data
                        w.document.body.appendChild(f)
                        this.content.anim({ class: ['pulsate-bck'] })

                    }
                })
                mainContent.styleMe({
                    'border-color': 'black',
                    'border-width': '2px',
                    'border-style': 'solid',
                    'background-repeat': 'no-repeat',
                    'margin': '40px',
                    'background-size': 'contain', 'background-image': `url("${data}")`, width: '100px', height: '100px'
                })
            } else {
                let nelem;
                let text = false;
                if (data.match(/audio\/(mp3|3pg|adts|flac|ogg)/)) {

                    nelem = new Elem({
                        tag: 'audio', controls: true, autobuffer: true, children: [
                            new Elem({ tag: 'source', src: data })
                        ]
                    })
                }
                else if (data.match(/video\/(webm|mp4|mpeg|mov)/)) {
                    nelem = new Elem({
                        tag: 'video', controls: true, autobuffer: true, children: [
                            new Elem({ tag: 'source', src: data })
                        ]
                    })
                }
                else {
                    nelem = new Elem({
                        tag: 'pre',
                        readonly: 'true', styles: {
                            width: '300px',
                            height: '300px',
                        }
                    })
                    nelem.content.setAttribute('readonly', true)
                    nelem.textContent = atob(data.split(',').pop())
                }

                mainContent.replaceWith(new Elem({ tag: 'kbd', text: `.${utilString.shorten(fileName.split('.').pop(), 4)} file` }))
                viewButton.addevent({
                    click() {
                        let win = open()
                        //     let clone = nelem.clone(true).content
                        win.document.body.appendChild(nelem.content)
                    }
                })
            }
        }
    </script>
</body>

</html>